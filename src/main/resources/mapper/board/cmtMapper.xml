<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hts.market.domain.board.repo.CmtRepo">



    <insert id="save">
        <selectKey keyProperty="cmtNo" order="BEFORE" resultType="long">
            select nvl(max(cmt_no),0)+1 from COMMENTS where cmt_brd_no=#{cmtBrdNo}
        </selectKey>
        insert into COMMENTS(cmt_no, cmt_writer_no, cmt_content, cmt_brd_no)
        values(#{cmtNo}, #{cmtWriterNo}, #{cmtContent}, #{cmtBrdNo})
    </insert>




    <!-- 제목, 내용, 조회수, 좋아요, 싫어요, 댓글수 중 사용자가 선택한 컬럼을 변경 -->
    <update id="update">


        <![CDATA[
            UPDATE
                COMMENTS
            SET
                cmt_content=#{cmtContent}
            WHERE
                 cmt_brd_no=#{cmtBrdNo} and cmt_writer_no=#{cmtWriterNo} and cmt_writer_no=#{cmtWriterNo}
        ]]>


    </update>


    <delete id="delete">
        <![CDATA[
            DELETE FROM
                COMMENTS
            WHERE
                cmt_writer_no=#{cmtWriterNo} and cmt_no=#{cmtNo}
        ]]>
    </delete>

    <select id="findAll" resultType="com.hts.market.domain.board.dto.CmtDto$Read">
        select cmt_no from COMMENTS

    </select>

</mapper>
